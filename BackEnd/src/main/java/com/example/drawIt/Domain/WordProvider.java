package com.example.drawIt.Domain;

import org.springframework.stereotype.Component;

import java.util.*;

@Component
public class WordProvider {

    private final Random random = new Random();

    /* =========================
       테마별 단어 풀
    ========================= */

    private final Map<String, List<String>> wordPoolByMode = Map.of(
            "RANDOM", List.of(
                    // 아래 모든 카테고리 단어 및 캐치마인드 전용 언어유희 포함
                    "소나기", "사과문", "오리발", "무에타이", "소방차", "지식인", "오이도", "장미칼",
                    "십자가", "도시락", "아이스크림", "구두룡", "모나리자", "발등불", "고무신", "배꼽잡기",
                    "인디언밥", "파출소", "해수욕장", "유모차", "연필깎이", "기상캐스터", "모기장", "주차장",
                    "해바라기", "가로수", "포장마차", "신라호텔", "모닥불", "바람개비", "물개박수", "모래시계",
                    "그림자", "풍선껌", "나침반", "확성기", "효자손", "돋보기", "주사위", "신호등",

                    // ANIMAL 카테고리
                    "개미핥기", "나무늘보", "카멜레온", "코뿔소", "불가사리", "딱따구리", "고슴도치", "오리너구리",
                    "달팽이", "망치상어", "전기뱀장어", "청개구리", "목도리도마뱀", "사막여우", "얼룩말", "코끼리",
                    "캥거루", "가오리", "두더지", "미어캣", "너구리", "순록", "비둘기", "펭귄", "기린", "하마",
                    "악어", "독수리", "타조", "거북이",

                    // POKEMON 카테고리
                    "피카츄", "라이츄", "파이리", "리자몽", "꼬부기", "거북왕", "이상해씨", "이상해꽃",
                    "이브이", "부스터", "샤미드", "쥬피썬더", "잠만보", "푸린", "고라파덕", "냐옹이",
                    "팬텀", "뮤츠", "루카리오", "잉어킹", "갸라도스", "디그다", "닥트리오", "메타몽",
                    "또가스", "찌리리공", "고래왕", "별가사리", "우츠동", "탕구리",

                    // FOOD 카테고리
                    "붕어빵", "솜사탕", "칼국수", "계란후라이", "비빔밥", "조개구이", "탕수육", "떡볶이",
                    "라면", "짜장면", "짬뽕", "파스타", "핫도그", "샌드위치", "케이크", "도넛",
                    "쿠키", "삼겹살", "삼각김밥", "회오리감자", "스테이크", "피자", "햄버거", "꽈배기",
                    "초밥", "소라빵", "호떡", "츄러스", "양꼬치", "부대찌개",

                    // JOB 카테고리
                    "경찰관", "소방관", "간호사", "선생님", "요리사", "제빵사", "파일럿", "군인",
                    "프로그래머", "디자이너", "화가", "사진작가", "기자", "작가", "만화가", "유튜버",
                    "스트리머", "농부", "어부", "정비사", "목수", "전기기사", "배달원", "택배기사",
                    "경비원", "청소부", "마술사", "우주비행사", "탐정", "지휘자", "발레리나",

                    // SPORT 카테고리
                    "축구", "농구", "야구", "배구", "테니스", "탁구", "배드민턴", "골프",
                    "볼링", "당구", "수영", "다이빙", "서핑", "스케이트", "스키", "스노보드",
                    "자전거", "마라톤", "양궁", "펜싱", "복싱", "태권도", "유도", "검도",
                    "레슬링", "씨름", "줄다리기", "컬링", "핸드볼", "피구",

                    // OBJECT 카테고리
                    "의자", "책상", "침대", "소파", "접시", "숟가락", "포크", "가위",
                    "연필", "지우개", "필통", "가방", "시계", "안경", "모자", "우산",
                    "열쇠", "창문", "리모컨", "핸드폰", "텔레비전", "허수아비", "변기", "가로등"
            ),

            "ANIMAL", List.of(
                    "개미핥기", "나무늘보", "카멜레온", "코뿔소", "불가사리", "딱따구리", "고슴도치", "오리너구리",
                    "달팽이", "망치상어", "전기뱀장어", "청개구리", "목도리도마뱀", "사막여우", "얼룩말", "코끼리",
                    "캥거루", "가오리", "두더지", "미어캣", "너구리", "순록", "비둘기", "펭귄", "기린", "하마",
                    "악어", "독수리", "타조", "거북이"
            ),

            "POKEMON", List.of(
                    "피카츄", "라이츄", "파이리", "리자몽", "꼬부기", "거북왕", "이상해씨", "이상해꽃",
                    "이브이", "부스터", "샤미드", "쥬피썬더", "잠만보", "푸린", "고라파덕", "냐옹이",
                    "팬텀", "뮤츠", "루카리오", "잉어킹", "갸라도스", "디그다", "닥트리오", "메타몽",
                    "또가스", "찌리리공", "고래왕", "별가사리", "우츠동", "탕구리"
            ),

            "FOOD", List.of(
                    "붕어빵", "솜사탕", "칼국수", "계란후라이", "비빔밥", "조개구이", "탕수육", "떡볶이",
                    "라면", "짜장면", "짬뽕", "파스타", "핫도그", "샌드위치", "케이크", "도넛",
                    "쿠키", "삼겹살", "삼각김밥", "회오리감자", "스테이크", "피자", "햄버거", "꽈배기",
                    "초밥", "소라빵", "호떡", "츄러스", "양꼬치", "부대찌개"
            ),

            "JOB", List.of(
                    "경찰관", "소방관", "간호사", "선생님", "요리사", "제빵사", "파일럿", "군인",
                    "프로그래머", "디자이너", "화가", "사진작가", "기자", "작가", "만화가", "유튜버",
                    "스트리머", "농부", "어부", "정비사", "목수", "전기기사", "배달원", "택배기사",
                    "경비원", "청소부", "마술사", "우주비행사", "탐정", "지휘자", "발레리나"
            ),

            "SPORT", List.of(
                    "축구", "농구", "야구", "배구", "테니스", "탁구", "배드민턴", "골프",
                    "볼링", "당구", "수영", "다이빙", "서핑", "스케이트", "스키", "스노보드",
                    "자전거", "마라톤", "양궁", "펜싱", "복싱", "태권도", "유도", "검도",
                    "레슬링", "씨름", "줄다리기", "컬링", "핸드볼", "피구"
            ),

            "OBJECT", List.of(
                    "의자", "책상", "침대", "소파", "접시", "숟가락", "포크", "가위",
                    "연필", "지우개", "필통", "가방", "시계", "안경", "모자", "우산",
                    "열쇠", "창문", "리모컨", "핸드폰", "텔레비전", "허수아비", "풍선껌", "나침반",
                    "확성기", "효자손", "돋보기", "주사위", "신호등", "변기", "가로등"
            )
    );

    /* =========================
       모드별 단어 선택 (중복 방지)
    ========================= */
    public String pickUniqueWord(GameState state, String mode) {

        // 1. 모드에 맞는 단어 풀 선택 (없으면 RANDOM)
        List<String> pool =
                wordPoolByMode.getOrDefault(mode, wordPoolByMode.get("RANDOM"));

        Set<String> usedWords = state.getUsedWords();
        List<String> available = new ArrayList<>();

        // 2. 아직 사용되지 않은 단어만 필터
        for (String w : pool) {
            if (!usedWords.contains(w)) {
                available.add(w);
            }
        }

        // 3. 모두 사용했으면 초기화
        if (available.isEmpty()) {
            usedWords.clear();
            available.addAll(pool);
        }

        // 4. 랜덤 선택
        String picked = available.get(random.nextInt(available.size()));
        usedWords.add(picked);

        return picked;
    }
}
