package com.example.drawIt.Domain;

import org.springframework.stereotype.Component;

import java.util.*;

@Component
public class WordProvider {

    private final Random random = new Random();

    /* =========================
       테마별 단어 풀
    ========================= */

    private final Map<String, List<String>> wordPoolByMode = Map.of(
            "RANDOM", List.of(
                    //동물
                    "강아지", "고양이", "토끼", "호랑이", "사자", "곰",
                    "말", "소", "돼지", "양", "닭", "오리",
                    "물고기", "상어", "고래", "문어",
                    "거북이", "펭귄", "독수리", "비둘기",

                    //포켓몬
                    "피카츄", "라이츄", "파이리", "리자몽",
                    "꼬부기", "거북왕", "이상해씨", "이상해꽃",
                    "이브이", "부스터", "샤미드", "쥬피썬더",
                    "잠만보", "푸린", "고라파덕", "냐옹",
                    "팬텀", "뮤", "뮤츠",
                    "루카리오", "잉어킹", "갸라도스",

                    //음식
                    "사과", "바나나", "딸기", "수박",
                    "포도", "오렌지", "레몬", "복숭아",
                    "체리", "파인애플",

                    "라면", "밥", "김치", "햄버거",
                    "피자", "치킨", "아이스크림", "케이크",
                    "핫도그", "샌드위치",

                    "떡볶이", "순대", "튀김", "초밥",
                    "우동", "짜장면", "짬뽕", "파스타",
                    "도넛", "쿠키",

                    //직업
                    "경찰", "소방관", "의사", "간호사",
                    "선생님", "학생", "요리사", "제빵사",
                    "운전기사", "파일럿",

                    "군인", "프로그래머", "디자이너", "화가",
                    "사진작가", "기자", "작가", "만화가",
                    "유튜버", "스트리머",

                    "농부", "어부", "정비사", "목수",
                    "전기기사", "배달원", "택배기사",
                    "경비원", "청소부",

                    //운동
                    "축구", "농구", "야구", "배구",
                    "테니스", "탁구", "배드민턴", "골프",
                    "볼링", "당구",

                    "수영", "다이빙", "서핑", "스케이트",
                    "스키", "스노보드", "자전거", "마라톤",
                    "철인삼종", "트라이애슬론",

                    "복싱", "태권도", "유도", "검도",
                    "레슬링", "펜싱", "양궁",
                    "사격", "승마", "요가",

                    //사물
                    "의자", "책상", "침대", "소파",
                    "컵", "접시", "숟가락", "포크",
                    "가위", "연필", "지우개", "필통",
                    "가방", "시계", "안경", "모자",
                    "우산", "열쇠", "문", "창문",
                    "리모컨", "핸드폰", "텔레비전"


            ),

            "ANIMAL", List.of(
                    "강아지", "고양이", "토끼", "호랑이", "사자", "곰",
                    "말", "소", "돼지", "양", "닭", "오리",
                    "물고기", "상어", "고래", "문어",
                    "거북이", "펭귄", "독수리", "비둘기"
            ),

            "POKEMON", List.of(
                    "피카츄", "라이츄", "파이리", "리자몽",
                    "꼬부기", "거북왕", "이상해씨", "이상해꽃",
                    "이브이", "부스터", "샤미드", "쥬피썬더",
                    "잠만보", "푸린", "고라파덕", "냐옹",
                    "팬텀", "뮤", "뮤츠",
                    "루카리오", "잉어킹", "갸라도스"
            ),

            "FOOD", List.of(
                    "사과", "바나나", "딸기", "수박",
                    "포도", "오렌지", "레몬", "복숭아",
                    "체리", "파인애플",

                    "라면", "밥", "김치", "햄버거",
                    "피자", "치킨", "아이스크림", "케이크",
                    "핫도그", "샌드위치",

                    "떡볶이", "순대", "튀김", "초밥",
                    "우동", "짜장면", "짬뽕", "파스타",
                    "도넛", "쿠키"
            ),

            "JOB", List.of(
                    "경찰", "소방관", "의사", "간호사",
                    "선생님", "학생", "요리사", "제빵사",
                    "운전기사", "파일럿",

                    "군인", "프로그래머", "디자이너", "화가",
                    "사진작가", "기자", "작가", "만화가",
                    "유튜버", "스트리머",

                    "농부", "어부", "정비사", "목수",
                    "전기기사", "배달원", "택배기사",
                    "경비원", "청소부"
            ),

            "SPORT", List.of(
                    "축구", "농구", "야구", "배구",
                    "테니스", "탁구", "배드민턴", "골프",
                    "볼링", "당구",

                    "수영", "다이빙", "서핑", "스케이트",
                    "스키", "스노보드", "자전거", "마라톤",
                    "철인삼종", "트라이애슬론",

                    "복싱", "태권도", "유도", "검도",
                    "레슬링", "펜싱", "양궁",
                    "사격", "승마", "요가"
            ),

            "OBJECT", List.of(
                    "의자", "책상", "침대", "소파",
                    "컵", "접시", "숟가락", "포크",
                    "가위", "연필", "지우개", "필통",
                    "가방", "시계", "안경", "모자",
                    "우산", "열쇠", "문", "창문",
                    "리모컨", "핸드폰", "텔레비전"
            )
    );

    /* =========================
       모드별 단어 선택 (중복 방지)
    ========================= */
    public String pickUniqueWord(GameState state, String mode) {

        // 1. 모드에 맞는 단어 풀 선택 (없으면 RANDOM)
        List<String> pool =
                wordPoolByMode.getOrDefault(mode, wordPoolByMode.get("RANDOM"));

        Set<String> usedWords = state.getUsedWords();
        List<String> available = new ArrayList<>();

        // 2. 아직 사용되지 않은 단어만 필터
        for (String w : pool) {
            if (!usedWords.contains(w)) {
                available.add(w);
            }
        }

        // 3. 모두 사용했으면 초기화
        if (available.isEmpty()) {
            usedWords.clear();
            available.addAll(pool);
        }

        // 4. 랜덤 선택
        String picked = available.get(random.nextInt(available.size()));
        usedWords.add(picked);

        return picked;
    }
}
